<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="mobile.css" />
    <title>Document</title>
  </head>
  <body>
    <nav>
      <!-- Desktop Menu -->
      <div class="nav__desktop">
        <ul>
          <li><a href="#overview">Overview</a></li>
          <li><a href="#objectives">Objectives</a></li>
          <li><a href="#background">Background</a></li>
          <li><a href="#requirements">Requirements</a></li>
          <li><a href="#submission">Submission</a></li>
          <li><a href="#grading-policy">Grading Policy</a></li>
          <li><a href="#readings">Readings</a></li>
          <li><a href="#plagiarism">Plagiarism</a></li>
        </ul>
      </div>

      <!-- Mobile Menu -->
      <div class="nav__mobile-menuoverlay" id="nav"></div>

      <a href="#nav" class="nav__mobile-btn">@</a>
      <a href="#blank" class="nav__mobile-btn--off">@</a>

      <ul class="nav__mobile-menu">
        <li><a href="#overview">Overview</a></li>
        <li><a href="#objectives">Objectives</a></li>
        <li><a href="#background">Background</a></li>
        <li><a href="#requirements">Requirements</a></li>
        <li><a href="#submission">Submission</a></li>
        <li><a href="#grading-policy">Grading Policy</a></li>
        <li><a href="#readings">Readings</a></li>
        <li><a href="#plagiarism">Plagiarism</a></li>
      </ul>

      <button class="nav__mobile-icon">
        <svg
          stroke="black"
          fill="none"
          class="nav__mobile-hamburger"
          viewBox="-10 -10 120 120"
        >
          <path
            class="line"
            stroke-width="10"
            stroke-linecap="round"
            stroke-linejoin="round"
            d="m 20 40 h 60 a 1 1 0 0 1 0 20 h -60 a 1 1 0 0 1 0 -40 h 30 v 70"
          ></path>
        </svg>
      </button>
    </nav>
    <main>
      <section class="hero">
        <h1 class="hero__title">CSIS0234</h1>
        <h3 class="hero__subtitle">COMPUTER NETWORKS</h3>
        <h5 class="hero__minititle">Programming Project — HTTP Proxy Server</h5>
        <div class="hero__card">
          <div class="banner">
            <div class="banner__img img-left"></div>
            <div>
              <h3>Total Points</h3>
              <h6>15 Points <small>(Version 1.1)</small></h6>
            </div>
          </div>
          <div class="banner">
            <div class="banner__img img-right"></div>
            <div>
              <h3>Deadline</h3>
              <h6>29 Apr 20xx, 5:00 AM</h6>
            </div>
          </div>
        </div>
      </section>

      <section id="overview">
        <h2>Overview</h2>
        <div class="overview__image">
          <figure>
            <img
              src="images/image1.png"
              alt="Image describing request and responses between client and target server through a proxy server"
            />
            <figcaption>Figure 1. HTTP Proxy Server</figcaption>
          </figure>
        </div>
        <div class="overview__content">
          <p>
            For this programming project, you are going to implement a web proxy
            server. This proxy server gets request messages from clients (web
            browsers), forwards the requests to target web server or another
            proxy server, obtains the corresponding response messages and sends
            the responses back to the clients. This proxy server should be able
            to handle all kinds of objects, not just HTML pages, but also images
            and audio files. Moreover, this proxy server should support
            persistent connections; a timeout timer should be used to terminate
            idle connection from client. To reduce the complexity of this
            programming project, the proxy server does not support caching
            mechanism.
          </p>
          <img alt="arrow" src="/images/arrow1.svg" />
          <img alt="arrow" src="images/arrow2.svg" />
        </div>
      </section>

      <section id="objectives">
        <h2>Objectives</h2>
        <div class="objectives__cards">
          <div class="objectives__cards--card">
            <div>
              <p>
                This is a good opportunity to further enhance your Socket
                programming skill in C/C++.
              </p>
            </div>
          </div>
          <div class="objectives__cards--card">
            <div>
              <p>
                Through this exercise, you should get a solid understanding of
                how the text-based networking protocol (such as HTTP) works as
                well as how to implement a standard networking protocol.
              </p>
            </div>
          </div>
          <div class="objectives__cards--card">
            <div>
              <p>
                A learning and assessment activity to support ILO2d and ILO4.
              </p>
            </div>
          </div>
        </div>
      </section>

      <section id="background">
        <h2>Background</h2>
        <p>
          <span>HTTP</span> is the transfer protocol used throughout the WWW.
          The HTTP protocol is a request/response protocol. When a client opens
          a connection, it immediately sends its request for a file. The web
          server then responds with the file or an error message. Each
          interaction consists of one request and one reply. Both are MIME-like
          message (MIME: The Multipurpose Internet Mail Extensions). Each
          request message includes a request line, a few header lines, a blank
          line, and the possible message body. Similar is the response message.
        </p>
        <p>
          Each request message includes a request line, a few header lines, a
          blank line, and the possible message body. Similar is the response
          message.
        </p>
        <i>
          Request-message = request-line *(message-header CRLF) CRLF [
          message-body ]
        </i>
        <i>
          Response-message = status-line *(message-header CRLF) CRLF [
          message-body ]
        </i>
        <p>
          For example, below are the request/response messages sent by a web
          client (curl) to the server to download a web document:
        </p>
        <div class="background__container">
          <div class="background__container--img">
            <figure>
            <img src="./images/image2.png" alt="screen" />
            <figcaption>Figure 2. Sample Web Request/Response messages</figcaption>
          </figure>
          </div>
          <h4>Non-Persistent Connection and Persistent Connection</h4>
          <p>
            In HTTP 1.0, after the TCP connection was established, a single
            request was sent over and a single response was sent back. Then the
            TCP connection was released. Establishing a separate connection for
            each file request incurs expensive overhead. In view of this
            deficiency, HTTP 1.1 was designed to support persistent connections.
            In HTTP 1.1, it is possible to establish a TCP connection, sends a
            request and gets a response, and then sends additional requests and
            gets additional responses. Our proxy server should support
            persistent connections between web clients and itself as well as
            between itself and target web/proxy servers.
          </p>
          <br />
          <p>
            If an HTTP 1.1 client sends multiple requests through a single
            connection, the server should send responses back in the same order
            as the requests - this is all it takes for a server to support
            persistent connections. The server should close a connection after
            the connection has been idle for long enough duration (not defined
            in the specification; usually set to 10 - 15 seconds).
          </p>
        </div>
      </section>

      <section id="requirements">
        <h2>Requirements</h2>
        <p>
          You are going to write a simple concurrent HTTP proxy server
          (http_proxy) using C socket, which works as follows:
        </p>
        <div class="requirements__cards">
          <div>
            <span>1</span>
            <p>
              The http_proxy server listens for connection requests from
              clients.
            </p>
          </div>
          <div>
            <span>2</span>
            <p>
              When there is a new TCP connection request, the http_proxy server
              creates a new process** to handle the new connection.
            </p>
          </div>
          <div>
            <span>3</span>
            <p>
              The new process sends any HTTP requests to the (origin/proxy)
              server and reads the server's reply.
            </p>
          </div>
          <div>
            <span>4</span>
            <p>Then it sends the responses back to the requesting client.</p>
          </div>
        </div>
        <small>
          ** Instead of using multiple processes, you can implement a multiple
          threads proxy server; the http_proxy server creates one new thread to
          handle each connection.
        </small>

        <div class="requirements__container">
          <div>
            <h5>Relay client requests and server responses</h5>
            <ol>
              <li>
                Directly connect to target web (origin) server:
                <ul>
                  <li>
                    Extract the “Host: ” header line from the client request
                    message to get the target server name
                  </li>
                  <li>Get the response and send back to client</li>
                  <li>
                    Connect and send the request to target server on port 80
                  </li>
                </ul>
              </li>
              <li>
                When configured to connect to another proxy server
                <ul>
                  <li>
                    Connect and send the request to the specified proxy server
                    and port
                  </li>
                  <li>Get the response and send back to client</li>
                </ul>
              </li>
            </ol>
          </div>
          <div>
            <h5>Persistent connections</h5>
            <p>
              With persistent connection, the proxy server leaves the connection
              open for serving more requests after handling a request. The
              server closes the connection as per the client instructs or if the
              timeout of idle connection has been reached. In order to let the
              client knows when is the end of a response message, all response
              messages on the persistent connection must have a self-defined
              message length using the Content-Length header field [except for
              the cases of dynamically generated web contents]. As our proxy
              server, in principle, is just a relay server, our proxy server
              does not need to handle that as the Content- Length headers should
              be generated by the origin servers.

              <br />

              To terminate an idle client connection, the proxy server can
              simply close the TCP connection and the client browser should
              detect this situation automatically. Similarly, a client browser
              can terminate an idle persistent connection by closing the TCP
              connection; the proxy server should detect this situation and
              should handle this correctly.
            </p>
          </div>
          <div>
            <h5>Support request types</h5>
            <p>
              For this programming project, HTTP requests generated by all test
              cases are GET request types. However, of unknown reasons, some
              browsers may generate POST requests under some situations (e.g.,
              Chrome browser).
            </p>
          </div>
          <div>
            <h5>Caching proxy server</h5>
            <p>
              You are not required to implement the caching mechanism in this
              project. That means all requests received from the clients are
              forwarded to the target origin/proxy server without the needs to
              search the cache memory as well as manage the cache memory.
            </p>
          </div>
          <div>
            <h5>How to start the HTTP proxy process</h5>
            <p>
              The http_proxy should be invoked as follow:
              <!-- prettier-ignore -->
              <code><span class="spacing">./http_proxy</span> myport <span class="secondary">[proxy_server:port]</span></code>

              The 1st parameter - myport is the port number that the http_proxy
              is listening on. The 2nd parameter - proxy_server:port is an
              optional argument. When proxy_server:port is specified, all the
              HTTP requests (responses) should be forwarded to (received from)
              proxy_server. The port in proxy_server:port is the port number
              that the proxy_server is listening on.
            </p>
          </div>
          <div>
            <h5>Output messages</h5>
            <p>
              To aid your programming and debugging, please print some log
              information to the screen. You are required to generate some
              output with major events:
            </p>
            <ul>
              <li>
                When receiving a new connection - identify the origin - display
                some useful information.
              </li>
              <li>
                When establishing a new connection - display the target server
                information
              </li>
              <li>
                When receiving a new request - display some information, e.g,,
                the request-line.
              </li>
              <li>
                When receiving a response message - display some information,
                e.g., message size
              </li>
              <li>
                When detecting the termination of persistent connections or
                server connection.
              </li>
            </ul>
            <p>Sample runs:</p>
            <!-- prettier-ignore -->
            <code>
              <span class="highlight">atctam@LinuxPC</span><span class="symbol">: ></span> ./http_proxy 54321<br />
              http_proxy listening on port 54321<br />
              http_proxy got a NEW connection (1) from 147.8.175.181<br />
              <span class="highlight">Received Request from user</span><span class="symbol">:</span> 349 bytes<br />
              Set up a connection to server i.cs.hku.hk<br />
              <span class="highlight">Requesting server</span><span class="symbol">:</span><br />
              GET http://i.cs.hku.hk/course/c0324/test/test-1.htm HTTP/1.1 <br />
              <span class="highlight">Host</span><span class="symbol">:</span> i.cs.hku.hk<br />
              <span class="highlight">User-Agent</span><span class="symbol">:</span> Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:14.0)<br />
              Gecko/20100101 Firefox/14.0.1<br />
              <span class="highlight">Accept</span><span class="symbol">:</span> text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />
              <span class="highlight">Accept-Language</span><span class="symbol">:</span> en-us,en;q=0.5<br />
              <span class="highlight">Accept-Encoding</span><span class="symbol">:</span> gzip, deflate<br />
              <span class="highlight">Proxy-Connection</span><span class="symbol">:</span> keep-alive<br />
              <span class="spacing">...</span><br /><br/>
              <span class="highlight">Received Response from Server</span><span class="symbol">:</span> 263 bytes<br />
              <span class="highlight">Received Response from Server</span><span class="symbol">:</span> 357 bytes<br />
              <span class="highlight">Received Response from Server</span><span class="symbol">:</span> 0 bytes<br />
              <span class="highlight">Connection close by server</span><span class="symbol">:</span> i.cs.hku.hk<br /><br/>
              Timeout - Persistent Connection (1) Closed<br />
            </code>
              
            <span class="or-line"></span>
            <!-- prettier-ignore -->
            <code>
              <span class="highlight">atctam@LinuxPC</span><span class="symbol">: ></span> ./http_proxy 54321 proxy.cs.hku.hk:8282<br/>
              http_proxy listening on port 54321<br/>
              http_proxy got a NEW connection (1) from 147.8.175.181<br/>
              <span class="highlight">Received Request from user</span><span class="symbol">:</span> 349 bytes<br/>
              Set up a connection to server proxy.cs.hku.hk<br/>
              <span class="highlight">Requesting server</span><span class="symbol">:</span><br/>
              GET http://i.cs.hku.hk/course/c0324/test/test-1.htm HTTP/1.1<br/>
              <span class="highlight">Host</span><span class="symbol">:</span> i.cs.hku.hk<br/>
              <span class="highlight">User-Agent</span><span class="symbol">:</span> Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:14.0)<br/>
              Gecko/20100101 Firefox/14.0.1<br/>
              <span class="highlight">Accept</span><span class="symbol">:</span> text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br/>
              <span class="highlight">Accept-Language</span><span class="symbol">:</span> en-us,en;q=0.5<br/>
              <span class="highlight">Accept-Encoding</span><span class="symbol">:</span> gzip, deflate<br/>
              <span class="highlight">Proxy-Connection</span><span class="symbol">:</span> keep-alive<br/>
              <span class="spacing">...</span><br/><br/>

              <span class="highlight">Received Response from Server</span><span class="symbol">:</span> 761 bytes<br/><br/>

              Timeout - Persistent Connection (1) Closed<br/>
            </code>
          </div>
          <div>
            <h5>Test cases</h5>
            <p>
              We will use (1) Firefox and (2) Chrome to connect to the following
              web sites for testing of your proxy program.
            </p>
            <!-- prettier-ignore -->
            <code>
              <span class="spacing">(1)</span> http://i.cs.hku.hk/course/c0324/test/test-1.htm</br >
              <span class="spacing">(2)</span> http://i.cs.hku.hk/~atctam/view/SimpleWebpage.html</br >
              <span class="spacing">(3)</span> http://i.cs.hku.hk/course/c0324/test/test-2.htm</br >
              <span class="spacing">(4)</span> http://www.simpleweb.org/</br >
            </code>
          </div>
        </div>
      </section>

      <section id="submission">
        <div class="submission__banner">
          <h3>Submission</h3>
          <p>
            A single file named http_proxy.c or http_proxy.cpp with in-line
            documentation. You should hand-in the program via the Moodle course
            Website.
          </p>

          <div class="submission__banner--cards">
            <div class="card">
              <h4>Computer Platform to Use</h4>
              <p>
                For this assignment, you are expected to work on any UNIX-like
                workstation, but you need to test your program on the latest
                distribution of Ubuntu before submission. You can use C/C++ to
                implement the program, and it should be successfully compiled
                with g++ (or gcc).
              </p>
            </div>
            <div class="card">
              <h4>Format for the documentation</h4>
              <ol>
                <li>
                  At the head of the submitted file, state clearly the
                  <ul>
                    <li>Student name:</li>
                    <li>Student No.:</li>
                    <li>Date and version:</li>
                    <li>Development platform:</li>
                    <li>Development language:</li>
                    <li>Compilation:</li>
                  </ul>
                </li>
                <li>
                  Inline comments (try to be detailed so that your code could be
                  understood by others easily)
                </li>
              </ol>
            </div>
          </div>
        </div>
      </section>

      <section id="grading-policy">
        <h2>Grading Policy</h2>
        <table>
          <tbody>
            <tr>
              <td rowspan="2" class="table__heading odd">
                <h3>
                  Documentation<br />
                  <small><strong>[1 point]</strong></small>
                </h3>
              </td>
              <td>
                <h4>High Quality <small>[0.6/1]</small></h4>
                <ul>
                  <li>
                    Include necessary documentation to clearly indicate the
                    logic of the program
                  </li>
                  <li>
                    Include necessary output messages for debugging and tracing
                    of the execution flow
                  </li>
                </ul>
              </td>
            </tr>
            <tr>
              <td>
                <h4>Standard Quality <small>[0.4/1]</small></h4>
                <ul>
                  <li>
                    Include required program and student's info at the beginning
                    of the program
                  </li>
                  <li>Include minimal inline comments</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td rowspan="2" class="table__heading even">
                <h3>
                  Connect to target origin web server<br />
                  <small><strong>[4 points]</strong></small>
                </h3>
              </td>
              <td>
                <ul>
                  <li>
                    By setting Firefox or Chrome to use http_proxy as the proxy
                    server, after removing all cache contents in browser's
                    cache, the browser can successfully download the
                    documents/objects related to the four test cases.
                    <small><strong>[2/4]</strong></small>
                  </li>
                </ul>
              </td>
            </tr>
            <tr>
              <td>
                <ul>
                  <li>
                    Without clearing browser's cache, the browser can
                    successfully display the four test cases by just using the
                    reload button to initiate the download requests.
                    <small><strong>[2/4]</strong></small>
                  </li>
                </ul>
              </td>
            </tr>
            <tr>
              <td rowspan="2" class="table__heading odd">
                <h3>
                  Connect to another proxy server<br />
                  <small><strong>[2.5 points]</strong></small>
                </h3>
              </td>
              <td>
                <ul>
                  <li>
                    By setting Firefox or Chrome to use http_proxy as the proxy
                    server, which in turn, is requesting the department proxy
                    server "proxy.cs.hku.hk:8282" to download all Web
                    documents/objects. After removing all cache contents in
                    browser's cache, the browser can successfully download the
                    documents/objects related to the test cases (2), (3), & (4).
                    <small><strong>[1.5/2.5]</strong></small>
                  </li>
                </ul>
              </td>
            </tr>
            <tr>
              <td>
                <ul>
                  <li>
                    Without clearing browser's cache, the browser can
                    successfully display the the test cases (2), (3), & (4) by
                    just using the reload button to initiate the download
                    requests. <small><strong>[1/2.5]</strong></small>
                  </li>
                </ul>
              </td>
            </tr>
            <tr>
              <td rowspan="2" class="table__heading even">
                <h3>
                  Persistent connection<br />
                  <small><strong>[1.5 points]</strong> </small>
                </h3>
              </td>
              <td>
                <ul>
                  <li>
                    The http_proxy server supports persistent connection with
                    the browser for downloading test cases (2), (3), & (4).
                    <small><strong>[1/1.5]</strong></small>
                  </li>
                </ul>
              </td>
            </tr>
            <tr>
              <td>
                <ul>
                  <li>
                    The http_proxy server can successfully terminate idle
                    persistent connection.
                    <small><strong>[0.5/1.5]</strong></small>
                  </li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
      </section>

      <section id="readings"></section>
      <section id="plagiarism">
        <div class="plagiarism_readings__banner">
          <div class="image"></div>
          <div class="readings-tab">
            <h4>Readings</h4>
            <ul>
              <li>
                Chapter 2.2 of Computer Networking - A Top-Down Approach
                Featuring the Internet, 6th edition by J. Kurose et. al
              </li>
              <li>Lecture 9</li>
              <li>
                Workshop 5 - Using WireShark to examine and understand SMTP and
                HTTP
              </li>
            </ul>
            <a href="#plagiarism">
              <span></span>
            </a>
          </div>
          <div class="plagiarism-tab">
            <h4>Plagiarism</h4>
            <p>
              Plagiarism is a very serious offence. Students should understand
              what constitutes plagiarism, the consequences of committing an
              offence of plagiarism, and how to avoid it. Please note that we
              may request you to explain to us how your program works as well as
              we may make use of software tools to detect software plagiarism.
            </p>
            <a href="#readings">
              <span></span>
            </a>
          </div>
        </div>
      </section>
    </main>
  </body>
</html>
